package org.evosuite.testcase;

import java.lang.reflect.Type;
import java.util.Collection;
import java.util.Stack;

import junit.framework.Assert;

import org.junit.Test;

public class GenericClassTest {

	private static class A{}
	
	public Collection<A> fieldA = null;
	public Stack<Object> fieldS = null;
	
	@Test
	public void test01() throws Throwable{

		/*
		 * This test case come from compilation issue found during SBST'13 competition:
		 * 
		 * String string0 = vM0.run(vM0.stack);
		 * 
		 * SUT at:  http://www.massapi.com/source/jabref-2.6/src/java/net/sf/jabref/bst/VM.java.html
		 * 
		 * Snippet of interest:
		 * 
		 * 1) Stack<Object> stack = new Stack<Object>();
		 * 2)  public String run(Collection<BibtexEntry> bibtex) {
		 */
		
		Collection<?> col0 = new Stack<Object>();
		Collection<A> col1 = new Stack();
		Collection col2 = new Stack();
		Collection col3 = new Stack<Object>();
		
		/*
		 *  following does not compile
		 *  
		 *  Collection<A> col = new Stack<Object>();
		 *  
		 *  but it can be generated by EvoSuite
		 */
		
		GenericClass stack = new GenericClass(Stack.class);
		GenericClass collection = new GenericClass(Collection.class);
		Assert.assertTrue(stack.isAssignableTo(collection));
		
		GenericClass objectStack = new GenericClass(col0.getClass());
		Assert.assertTrue(objectStack.isAssignableTo(collection));
		
		Type t0 = col0.getClass().getGenericSuperclass();
		Assert.assertEquals("java.util.Vector<E>", t0.toString());
		Type t1 = col1.getClass().getGenericSuperclass();
		Assert.assertEquals("java.util.Vector<E>", t1.toString());
		
		System.out.println(this.getClass().getField("fieldA").getType());
	}
	
}
